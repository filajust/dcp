#!/usr/bin/env bash

set -e

log_info() {
  printf "\033[0;34m[%s]:\033[0m %s\n" \
         "$(date "+%Y-%m-%d %H:%M:%S")" \
         "$*"
}

log_error() {
  printf >&2 "\033[1;37;41m[%s]:\033[0m %s\n" \
             "$(date "+%Y-%m-%d %H:%M:%S")" \
             "$*"
}

main() {
  if ! git rev-parse --is-inside-work-tree &> /dev/null; then
    log_error "Error: not inside a Git work tree"
    return 1
  fi

  read -p "What's the motto (all caps)? " -n 4 -r

  if [[ "${REPLY}" = "YOLO" ]]; then
    printf >&2 "\n"

    git commit --all --message="DEAL WITH IT"

    git push origin +master
  fi
}

main "$@"
